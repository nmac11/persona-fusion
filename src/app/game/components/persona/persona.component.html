<div *ngIf="persona; else noPersona"
     gdColumns="minmax(0, 1fr)"
     gdColumns.gt-sm="320px minmax(0, 1fr)"
     gdRows="max-content auto"
     gdRows.gt-sm
     gdGap="16px">
  <shared-persona-info [persona]="persona"></shared-persona-info>
  <mat-card class="mat-elevation-z2">
    <mat-tab-group *ngIf="allowedFusion(); else blockedFusion">
      <mat-tab label="SPECIAL FUSION" *ngIf="specialFusion.length">
        <mat-nav-list>
          <a mat-line mat-list-item *ngFor="let p of specialFusion"
             routerLink="..//{{ p.name | lowercase }}">
             <span mat-line>{{p.name}}</span>
             <span mat-line>{{ p.arcanaName }} / Level {{ p.level }}</span>
          </a>          
        </mat-nav-list>
        <a mat-flat-button color="primary" routerLink="../../simulator" [queryParams]="queryParams()"
           style="width: 100%; margin-top: 16px">SIMULATE</a>
      </mat-tab>
      <mat-tab *ngIf="!persona.special" label="NORMAL">
        <game-normal-fusions [persona]="persona"></game-normal-fusions>
      </mat-tab>
      <mat-tab *ngIf="showTriangleFusions()" label="TRIANGLE">
        <game-triangle-fusions [persona]="persona"></game-triangle-fusions>
      </mat-tab> -->
      <mat-tab *ngIf="showGemFusions()" label="GEM">
        <game-gem-fusions [persona]="persona"></game-gem-fusions>
      </mat-tab>
    </mat-tab-group>
  </mat-card>

</div>

<ng-template #noPersona>
  <h2 class="mat-h2">Persona not found</h2>
  <p class="mat-body-1">
    Go back to the list.
  </p>
  <a routerLink="../.." mat-button color="accent">GO BACK</a>
</ng-template>

<ng-template #blockedFusion>
  <h2 class="mat-h2">Not allowed</h2>
  <p class="mat-body-1">
    You do not meet the requirements to fuse this Persona. Please check your settings.
  </p>
  <a routerLink="../../settings" mat-button color="accent">GO TO SETTINGS</a>
</ng-template>